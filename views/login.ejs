<html lang="en">
<body>
    <%- include('./partials/nav.ejs') %>

    <Form id="login-form">
        <input type="text" autocomplete="off" autocapitalize="off" id="email" placeholder="email" />
        <input type="password" autocomplete="off" autocapitalize="off" id="password" placeholder="password">
        <input type="submit" value="Submit">
    </Form>

    <script>
        const form = document.getElementById('login-form')

        form.addEventListener('submit', loginUser)

        async function loginUser(event) {
            event.preventDefault() // This will prevent the refresh event
            const email = document.getElementById('email').value
            const password = document.getElementById('password').value

            const result = await fetch('/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify ({
                    email,
                    password
                })
            }).then((res) => res.json())
            if(result.status === 200) {
                localStorage.setItem('token', result.data)
            }
        }
    </script>

    <%- include('./partials/footer.ejs') %>    
</body>
</html>